Status: DRAFT  
ID: map_poi  

# Точка интереса

## Кратко
Точка интереса (POI) — это статичный объект мира, привязанный к определённой позиции в структуре карты мира, представляющий потенциальную цель, источник событий или контейнер сущностей, **не участвующих в пространственной логике карты**.

Точка интереса **не является сущностью на карте** и не участвует в движении, обнаружении и встречах как активный участник.

---

## Инварианты

### 1. Точка интереса не является сущностью на карте  
Точка интереса:
- не имеет пространственного статуса,
- не движется,
- не обнаруживается как сущность,
- не участвует во встречах.

POI существует на карте как **якорь и ориентир**, а не как активный участник пространства.

---

### 2. Пространственная привязка POI  
Каждая точка интереса привязана к структуре карты:
- одному узлу,
- или набору узлов,
- или области графа (TBD).

Эта привязка используется для:
- вычисления дистанции до POI,
- логики обнаружения относительно POI,
- ограничений поведения контролёров (патрули, зоны влияния и т.п.).

---

### 3. POI как контейнер сущностей мира  
Точка интереса может содержать сущности мира (NPC, отряды, жителей, гарнизоны и т.п.), которые:

- **отсутствуют на карте мира**,
- не имеют позиции и пространственного статуса,
- не участвуют в движении, обнаружении и встречах.

Нахождение сущности внутри POI означает её **дерегистрацию из карты**.

---

### 4. Взаимодействие сущности с POI  
Когда сущность на карте достигает позиции POI:
- карта фиксирует достижение якорной позиции,
- может быть инициировано событие или встреча (через внешние системы),
- по внешнему сигналу сущность может быть дерегистрирована из карты (вход внутрь POI).

Карта не принимает решений о характере взаимодействия с POI.

---

### 5. Возврат сущности из POI на карту  
Выход сущности из POI:
- осуществляется внешней системой (город, квест, фракция и т.п.),
- приводит к регистрации сущности в карте,
- сущность появляется на карте в якорной позиции POI (если не указано иное).

---

## Использование POI в логике карты

Точка интереса может использоваться картой как:
- якорь для вычисления дистанции,
- ориентир для обнаружения,
- цель движения (через намерения контролёров),
- источник внешних сигналов (через интеграцию с другими системами).

---

## Границы ответственности

Точка интереса **не**:
- управляет сущностями на карте,
- не изменяет статусы сущностей,
- не принимает решений о движении,
- не участвует в пространственных процессах напрямую.

Вся активная логика, связанная с POI, реализуется **вне карты**.

---

## Примечания (TBD)

- Типы точек интереса (город, логово, подземелье, портал и т.п.) — TBD.
- Правила областей влияния POI — TBD.
- Возможность временных POI — TBD.
